{% extends 'base.html.twig' %}

{% block body %}
<link rel="stylesheet" href="/assets/stylesheets/presta.css">

<div class="titrePresta">
    <h1>Nos prestations</h1>
    {% if app.user and app.user.droitUtil == 1 %}
    <button onclick="window.location.href = '/prestation/add'">Ajouter une prestation</button>
    {% endif %}
</div>

{% set prestationsCount = prestations|length %}
{% set rowCount = prestationsCount <= 4 ? 4 : (prestationsCount <= 8 ? 8 : (prestationsCount <= 12 ? 12 : prestationsCount)) %}
<div class="wrapper" style="grid-template-rows: repeat({{ rowCount }}, 125px)">
    {% for prestation in prestations %}
        <div class="p{{ prestation.id }}"></div>
        <div class="txtp{{ prestation.id }}">
            <h4>{{ prestation.libPrestation }}</h4>
            <button class="en-savoir-plus" data-target="prestation-details-{{ prestation.id }}">En savoir plus</button>
        </div>
        

    {% endfor %}
</div>
    {% for prestation in prestations %}

        <div id="prestation-details-{{ prestation.id }}" class="prestation-details">
            <img class="image-detail" src="/assets/img/presta/presta_{{ prestation.id }}.jpg">
            <div id="details" class="details">
                <h2>{{ prestation.libPrestation }}</h2>
                <p>{{ prestation.descPrestation }}</p>
                <p>Prix : {{ prestation.prixTTC }} €</p>
                <p>Nécessite {{ prestation.mainOeuvre }} personnes.</p>
                <p>Durée : {{ prestation.dureePrestation }} heure(s).</p>
            {% if app.user and app.user.droitUtil == 1 %}
            <div class="buttonsAdmin">
                <form class="frmEdit" action="{{ path('app_prestation_edit', {'id': prestation.id}) }}" method="post">
                <input type="hidden" name="_method" value="EDIT">
                <input type="hidden" name="_token" value="{{ csrf_token('edit' ~ prestation.id) }}">
                <button type="submit" class="EditButton">Modifier</button>
                </form>
                <form class="frmDelete" action="{{ path('app_prestation_delete', {'id': prestation.id}) }}" method="post">
                <input type="hidden" name="_method" value="DELETE">
                <input type="hidden" name="_token" value="{{ csrf_token('delete' ~ prestation.id) }}">
                <button type="submit">Supprimer</button>
                </form>
            </div>
            {% endif %}
            </div>
        </div>
    {% endfor %}

<script src="js/presta.js"></script>

{% endblock %}
